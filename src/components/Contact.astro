---
/* File: src/components/Contact.astro */
const siteUrl = "https://optyp-com.github.io/optyp.github.io"; // update if needed
---
<!-- Contact trigger area (can be placed on pages to open modal) -->
<section id="contact-cta" class="py-12 bg-transparent">
  <div class="container-custom text-center">
    <h2 class="text-3xl font-extrabold mb-3">Ready to improve your chances?</h2>
    <p class="text-gray-700 max-w-xl mx-auto mb-6">Book a review or send your resume — we’ll respond within 24 hours.</p>
    <div class="flex justify-center gap-3">
      <button class="btn-primary" onclick="openContactForm()">Get Started</button>
      <a href="#plans" class="btn-ghost">See Plans</a>
    </div>
  </div>
</section>

<!-- Modal -->
<div id="contact-modal" aria-hidden="true"
     class="fixed inset-0 z-50 hidden opacity-0 pointer-events-none transition-opacity duration-300">
  <div class="absolute inset-0 bg-black/45" aria-hidden="true" onclick="closeContactForm()"></div>

  <div class="flex items-center justify-center min-h-screen px-4">
    <div role="dialog" aria-modal="true" aria-labelledby="contact-title"
         class="glass max-w-3xl w-full rounded-2xl p-6 relative">
      <button aria-label="Close modal" class="absolute right-4 top-4 text-gray-600" onclick="closeContactForm()">
        ✕
      </button>

      <div class="grid md:grid-cols-2 gap-6 items-start">
        <div>
          <h3 id="contact-title" class="text-2xl font-extrabold mb-2">Send your resume or book a review</h3>
          <p class="text-sm text-gray-700/80 mb-4">Share a resume file or summary and we’ll return a prioritized checklist and improvement estimate.</p>

          <ul class="text-sm space-y-3">
            <li class="flex items-start gap-3"><strong class="text-brand">✓</strong> ATS scan + visual design suggestions</li>
            <li class="flex items-start gap-3"><strong class="text-brand">✓</strong> LinkedIn headline & summary quick fix</li>
            <li class="flex items-start gap-3"><strong class="text-brand">✓</strong> Turnaround within 48 hours</li>
          </ul>
        </div>

        <form id="contact-form" class="space-y-4" onsubmit="handleContactSubmit(event)">
          <div>
            <label class="text-sm font-medium">Full name</label>
            <input id="name" name="name" required class="w-full mt-1 p-3 rounded-lg subtle-border" placeholder="Jane Doe" />
          </div>

          <div>
            <label class="text-sm font-medium">Email</label>
            <input id="email" name="email" type="email" required class="w-full mt-1 p-3 rounded-lg subtle-border" placeholder="you@example.com" />
          </div>

          <div>
            <label class="text-sm font-medium">Message (short)</label>
            <textarea id="message" name="message" rows="4" class="w-full mt-1 p-3 rounded-lg subtle-border" placeholder="Paste your LinkedIn or a short note..."></textarea>
          </div>

          <div>
            <label class="text-sm font-medium">Upload resume (optional)</label>
            <input id="resume" name="resume" type="file" accept=".pdf,.doc,.docx" class="w-full mt-2" />
          </div>

          <div class="flex items-center gap-3">
            <button type="submit" class="btn-primary">Send & Request Review</button>
            <button type="button" class="btn-ghost" onclick="closeContactForm()">Cancel</button>
          </div>

          <div id="contact-msg" class="text-sm text-green-600 hidden mt-2">Thanks! We’ll respond soon.</div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  window.closeContactForm = function() {
    const modal = document.getElementById('contact-modal');
    if (!modal) return;
    modal.classList.add('hidden','opacity-0','pointer-events-none');
    document.body.style.overflow = '';
  };

  window.openContactForm = function() {
    const modal = document.getElementById('contact-modal');
    if (!modal) return;
    modal.classList.remove('hidden','opacity-0','pointer-events-none');
    modal.classList.add('opacity-100');
    document.body.style.overflow = 'hidden';
    // focus first input
    setTimeout(()=>document.getElementById('name')?.focus(), 120);
  };

  async function handleContactSubmit(e) {
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const message = document.getElementById('message').value.trim();
    // Minimal client-side validation
    if (!name || !email) {
      alert('Please provide name and email.');
      return;
    }

    // TODO: wire this to your backend or form endpoint
    // For now we show a success message and close modal after a short delay.
    document.getElementById('contact-msg').classList.remove('hidden');
    setTimeout(()=> {
      closeContactForm();
      document.getElementById('contact-form').reset();
      document.getElementById('contact-msg').classList.add('hidden');
      alert('Demo: message sent (client-only). Wire to backend endpoint for real submissions.');
    }, 900);
  }
</script>
